{% extends "index.html" %}
{% load static %}

<html>
    {% block content %}
    <body>

        <h1 style="font-family: quicksand;">Map from Google</h1>
        <div id="googleMap" style="width:100%;height:400px;"></div>
        
        

        <script>
            
            window.addEventListener("click", getLocation)
            // document.ready(load())

            var map
            var user_latitude 
            var user_longitude 

            // function load() {
            //     getLocation()
            // }

            function getLocation() {
            // Check whether browser supports Geolocation API or not
                if (navigator.geolocation) { // Supported
                    navigator.geolocation.getCurrentPosition(getPosition) 
                    var pos = {
                        lat: position.coords.latitude,
                        lng: position.coords.longitude
                    }

                    infoWindow.setPosition(pos);
                    infoWindow.setContent('Location found.');
                    infoWindow.open(map);
                    map.setCenter(pos);
                } else { // Not supported
                    alert("Oops! This browser does not support HTML Geolocation.");
                }
            }

            function getPosition(position) {
                console.log(position);

                user_latitude = position.coords.latitude;
                user_longitude = position.coords.longitude;

            }

            function myMap() {
                var directionsService = new google.maps.DirectionsService();
                var directionsDisplay = new google.maps.DirectionsRenderer();
                
                var mapProp = {
                    center: new google.maps.LatLng(user_latitude, user_longitude),
                    zoom: 14,
                };

                map = new google.maps.Map(document.getElementById("googleMap"), mapProp);
            }

            function calcRoute() {
                var start = google.maps.LatLng(user_latitude, user_longitude);
                var end = document.getElementById('Los Angeles').value;     //replace los angeles with destination var//
                var request = {
                    origin: start,
                    destination: end,
                    travelMode: 'TRANSIT',  //can replace transit with var//
                    avoidferries: false, 
                    avoidhighways: false,
                    avoidtolls: false,
                    unitSystem: google.maps.UnitSystem.IMPERIAL,

                };

                directionsService.route(request, function(result, status) {
                    if (status == 'OK') {
                    directionsDisplay.setDirections(result);
                    }
                    
                });
            }

        </script>

        <script 
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBatSFsLO7FcTGtpxjP7FcAwKaevJb1N_k&callback=myMap"
            type="text/javascript"
        >
        </script>


        
        

    </body>

    {% endblock content %}
</html>